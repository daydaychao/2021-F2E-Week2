import{d as N,o as n,b as c,e,j as i,k as d,g as p,l as C,m as b,n as Y,w as Z,f as B,p as W,v as q,F as J,q as K,t as m,s as O,x as Q}from"./vendor.1e1f29c7.js";import{u as $,g as R,S as X,a as T}from"./enum.a18aba3e.js";import{M}from"./map.b74344c3.js";import{_ as tt}from"./plugin-vue_export-helper.5a098b48.js";var et="https://divinechao.github.io/2021-F2E-Week2/assets/home_hurry.3f21d96a.png";const it={class:"GPS"},ot={key:0},at=p("\u6309\u4E0BGPS\u8B93\u6211\u5011\u76F4\u63A5"),st=e("br",null,null,-1),nt=p("\u5E6B\u60A8\u5B9A\u4F4D\u4F4D\u7F6E"),ct=e("svg",{xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink","aria-hidden":"true",role:"img",width:"1em",height:"1em",preserveAspectRatio:"xMidYMid meet",viewBox:"0 0 1200 1200"},[e("path",{d:"M0 972.138V556.629c2.192-43.973 37.788-75.724 76.898-76.252h186.106c53.196-40.854 90.897-97.554 142.165-138.611c18.094-14.432 32.095-30.479 42.003-48.142c32.214-63.281 12.695-136.954 58.481-187.399c92.008-39.482 202.231 15.751 233.279 102.423c24.405 70.78 8.052 141.366-22.294 203.877c109.856-.182 219.71.708 329.563 1.292c89.434 6.678 153.202 66.892 153.797 152.504c-.244 86.275-74.623 149.017-153.797 150.565h-129.24c-4.308 25.417-12.709 48.465-25.202 69.144c7.239 53.145-9.327 105.247-41.356 142.812c-17.576 306.75-419.443 124.761-569.952 120.193H76.898C32.617 1046.939.528 1011.445 0 972.138zm277.221 0c120.425 2.591 531.909 184.658 492.407-76.252c43.546-23.471 60.301-86.286 33.603-126.01c40.566-40.005 52.118-90.265 12.925-129.887c38.771 0 77.113-.216 115.023-.646c37.911-.431 76.253-.646 115.024-.646c44.371-.933 75.122-33.487 75.606-72.374c-1.014-45.976-35.914-75.137-75.606-75.606c-150.385-.008-298.632-1.276-438.126-1.292c12.555-100.763 132.769-237.585 10.017-316.963c-19.652-9.652-35.367-13.749-55.896-10.017c-3.446 1.723-5.385 3.447-5.816 5.17c-.431 1.723-1.076 4.523-1.938 8.4c-13.044 79.87-25.221 159.73-87.237 212.601c-68.263 52.343-108.514 134.749-186.752 168.014h-3.231l-.003 415.508z",fill:"currentColor"})],-1),lt=[at,st,nt,ct],ut=e("svg",{xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink","aria-hidden":"true",role:"img",preserveAspectRatio:"xMidYMid meet",viewBox:"0 0 24 24"},[e("path",{d:"M12 2C7.589 2 4 5.589 4 9.995C3.971 16.44 11.696 21.784 12 22c0 0 8.029-5.56 8-12c0-4.411-3.589-8-8-8zm0 12c-2.21 0-4-1.79-4-4s1.79-4 4-4s4 1.79 4 4s-1.79 4-4 4z",fill:"white"})],-1),rt=p("GPS "),dt=[ut,rt],_t=N({emits:["GpsEvent"],setup(a,{emit:t}){const l=$();async function k(){console.log("getGPS"),navigator.geolocation||(alert("\u6293\u4E0D\u5230\u60A8\u7684GPS\u8CC7\u6599"),l.setLocation(0,0)),await navigator.geolocation.getCurrentPosition(function(u){l.setLocation(22.6037664,120.3010409),console.log("location",l.userLocation[0],l.userLocation[1]),t("GpsEvent")})}return(u,S)=>(n(),c("section",it,[e("article",null,[!i(l).userLocation[0]&&!i(l).userLocation[1]?(n(),c("span",ot,lt)):d("",!0)]),e("article",{class:"GPS_circle",onClick:S[0]||(S[0]=f=>k())},dt)]))}});const r=a=>(O("data-v-48ace480"),a=a(),Q(),a),ht={class:"content"},vt={key:0,style:{position:"absolute",top:"0",left:"0",height:"100%",width:"100%"}},pt=p(".. "),gt={key:1,style:{position:"absolute",top:"0",left:"0",height:"100%",width:"100%"}},mt={class:"car-nav"},St={class:"Homeselect"},wt=["value"],bt={key:0},yt=r(()=>e("svg",{xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink","aria-hidden":"true",role:"img",width:"1em",height:"1em",preserveAspectRatio:"xMidYMid meet",viewBox:"0 0 1200 1200"},[e("path",{d:"M227.863 1200h415.508c43.973-2.192 75.725-37.788 76.253-76.898V936.995c40.854-53.196 97.553-90.897 138.61-142.165c14.432-18.094 30.479-32.095 48.142-42.003c63.281-32.214 136.955-12.695 187.399-58.481c39.482-92.008-15.751-202.231-102.423-233.279c-70.78-24.404-141.366-8.051-203.878 22.294c.182-109.856-.708-219.71-1.292-329.564C779.505 64.363 719.291.594 633.679 0c-86.275.244-149.017 74.623-150.565 153.796v129.241c-25.417 4.308-48.465 12.708-69.144 25.202c-53.145-7.24-105.247 9.327-142.811 41.356c-306.751 17.576-124.761 419.443-120.194 569.951v203.555c2.096 44.282 37.59 76.37 76.898 76.899zm0-277.222c-2.591-120.425-184.658-531.908 76.252-492.406c23.47-43.546 86.285-60.301 126.009-33.603c40.005-40.566 90.265-52.118 129.887-12.925c0-38.771.216-77.113.646-115.024s.646-76.252.646-115.024c.933-44.37 33.487-75.122 72.375-75.605c45.975 1.014 75.136 35.914 75.605 75.605c.008 150.385 1.276 298.632 1.292 438.126c100.763-12.555 237.585-132.769 316.963-10.017c9.652 19.652 13.749 35.367 10.017 55.896c-1.724 3.446-3.446 5.385-5.17 5.816c-1.723.431-4.523 1.076-8.4 1.938c-79.87 13.044-159.73 25.221-212.601 87.237c-52.343 68.263-134.749 108.514-168.013 186.752v3.231H227.863z",fill:"currentColor"})],-1)),kt=p(" \u9078\u64C7\u60F3\u67E5\u8A62\u7684\u7E23\u5E02 "),At=[yt,kt],Ct={class:"Homecar"},Bt={class:"car-btns"},ft={key:0},xt=r(()=>e("svg",{xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink","aria-hidden":"true",role:"img",width:"1em",height:"1em",preserveAspectRatio:"xMidYMid meet",viewBox:"0 0 1200 1200"},[e("path",{d:"M227.863 1200h415.508c43.973-2.192 75.725-37.788 76.253-76.898V936.995c40.854-53.196 97.553-90.897 138.61-142.165c14.432-18.094 30.479-32.095 48.142-42.003c63.281-32.214 136.955-12.695 187.399-58.481c39.482-92.008-15.751-202.231-102.423-233.279c-70.78-24.404-141.366-8.051-203.878 22.294c.182-109.856-.708-219.71-1.292-329.564C779.505 64.363 719.291.594 633.679 0c-86.275.244-149.017 74.623-150.565 153.796v129.241c-25.417 4.308-48.465 12.708-69.144 25.202c-53.145-7.24-105.247 9.327-142.811 41.356c-306.751 17.576-124.761 419.443-120.194 569.951v203.555c2.096 44.282 37.59 76.37 76.898 76.899zm0-277.222c-2.591-120.425-184.658-531.908 76.252-492.406c23.47-43.546 86.285-60.301 126.009-33.603c40.005-40.566 90.265-52.118 129.887-12.925c0-38.771.216-77.113.646-115.024s.646-76.252.646-115.024c.933-44.37 33.487-75.122 72.375-75.605c45.975 1.014 75.136 35.914 75.605 75.605c.008 150.385 1.276 298.632 1.292 438.126c100.763-12.555 237.585-132.769 316.963-10.017c9.652 19.652 13.749 35.367 10.017 55.896c-1.724 3.446-3.446 5.385-5.17 5.816c-1.723.431-4.523 1.076-8.4 1.938c-79.87 13.044-159.73 25.221-212.601 87.237c-52.343 68.263-134.749 108.514-168.013 186.752v3.231H227.863z",fill:"currentColor"})],-1)),Et=p(" \u85C9\u7531\u501F / \u9084\u8ECA\u7684\u6309\u9215\u4F86\u770B\u6240\u5269\u7684\u6578\u91CF\u5594 "),Ft=[xt,Et],Dt={class:"map_content"},Lt={key:0,class:"Homeimg"},Nt=r(()=>e("img",{src:et},null,-1)),$t=r(()=>e("h1",null,"\u8D95\u5FEB\u958B\u59CB\u9A0E\u4E0AUBike\u56DB\u8655\u65C5\u904A\u5427 !",-1)),Rt=r(()=>e("p",null,"\u908A\u9A0E\u8173\u8E0F\u8ECA\u908A\u7528\u624B\u6A5F\u662F\u5F88\u5371\u96AA\u7684\u5594 (\xB4\uFF65\u03C9\uFF65`)",-1)),Mt=[Nt,$t,Rt],Vt={key:2,class:"HomeCurrentStation"},Ht={class:"StationName"},Pt={class:"StationNum"},It=r(()=>e("h5",null,"\u53EF\u501F",-1)),Ut={class:"number"},zt=r(()=>e("span",{class:"line"},"|",-1)),Gt=r(()=>e("h5",null,"\u53EF\u9084",-1)),jt={class:"number"};var y;(function(a){a[a.city=0]="city",a[a.gps=1]="gps",a[a.undefined=2]="undefined"})(y||(y={}));const Yt=N({setup(a){const t=$(),l=R(X),k=R(T),u=C();b(()=>t.userLocation);let S=b(()=>t.userLocation[0]),f=b(()=>t.userLocation[0]),V=b(()=>t.getHasLocation),g=C(2),H=t.nearAvailability,w=Y({rent:0,return:0,name:"",address:""});function A(_){console.log("updateCurrentByUID");let o=H.find(h=>h.StationUID===_);w.rent=o==null?void 0:o.AvailableRentBikes,w.rent=o==null?void 0:o.AvailableReturnBikes;let s=t.bikeStations.find(h=>h.StationUID===_);w.name=s==null?void 0:s.StationName.Zh_tw,w.address=s==null?void 0:s.StationAddress.Zh_tw}function P(){u.value&&t.getStationData(u.value,S.value,f.value)}function I(){u.value&&t.getAvailabilityData(u.value)}function U(){t.userLocation&&t.getNearByStationData(t.userLocation[0],t.userLocation[1])}function z(){t.userLocation&&t.getNearByAvailabilityData(t.userLocation[0],t.userLocation[1])}async function G(){console.log("handleSelect"),await P(),await I(),g.value=0}async function j(){console.log("handleGPS"),await z(),await U(),g.value=1}Z(()=>t.nearAvailability,(_,o)=>{var s;console.log("\u8CC7\u6599\u8B8A\u66F4\u5C31update"),!!((s=t.nearAvailability[0])==null?void 0:s.StationUID)&&A(t.nearAvailability[0].StationUID)},{immediate:!0,deep:!0});const x=C(!0);function E(_){switch(_){case"rent":x.value=!0,t.setIsRent(!0),A(t.getSelectedBikeStation.StationUID);break;case"return":x.value=!1,t.setIsRent(!1),A(t.getSelectedBikeStation.StationUID)}}return(_,o)=>{var s,h,F,D;return n(),c("main",ht,[i(t).bikeStations.length>0&&i(g)===0?(n(),c("article",vt,[pt,B(M,{location:[i(t).bikeStations[0].StationPosition.PositionLat,i(t).bikeStations[0].StationPosition.PositionLon],stations:i(t).bikeStations,availability:i(t).bikeAvailability,isRent:i(t).getIsRent},null,8,["location","stations","availability","isRent"])])):d("",!0),i(V)&&i(g)===1?(n(),c("article",gt,[B(M,{location:[i(t).userLocation[0],i(t).userLocation[1]],stations:i(t).getNearByStations,availability:i(t).getNearByAvailability,isRent:i(t).getIsRent},null,8,["location","stations","availability","isRent"])])):d("",!0),e("article",mt,[e("div",St,[W(e("select",{class:"form-control",value:"\u8F38\u5165\u60F3\u67E5\u8A62\u7684\u5730\u9EDE","onUpdate:modelValue":o[0]||(o[0]=v=>u.value=v),onChange:G},[(n(!0),c(J,null,K(i(l),(v,L)=>(n(),c("option",{key:L,value:v},m(i(k)[L]),9,wt))),128))],544),[[q,u.value]]),y?d("",!0):(n(),c("span",bt,At))]),e("div",Ct,[e("div",Bt,[e("button",{type:"button",class:"disable_g btn-orange se_btn",onClick:o[1]||(o[1]=v=>E("rent"))},"\u501F\u8ECA"),e("button",{type:"button",class:"disable_g btn-green se_btn",onClick:o[2]||(o[2]=v=>E("return"))},"\u9084\u8ECA")]),y?d("",!0):(n(),c("span",ft,Ft))])]),e("article",Dt,[i(g)==2?(n(),c("article",Lt,Mt)):d("",!0),B(_t,{onGpsEvent:o[3]||(o[3]=v=>j())})]),i(t).getSelectedBikeStation.name!=null?(n(),c("article",Vt,[e("div",Ht,[e("h2",null,m(((s=i(t).getSelectedBikeStation)==null?void 0:s.name)||"\u8ACB\u9EDE\u64CA\u81EA\u884C\u8ECA\u7AD9\u9EDE"),1),e("h4",null,m((h=i(t).getSelectedBikeStation)==null?void 0:h.address),1)]),e("div",Pt,[e("div",null,[It,e("span",Ut,m(((F=i(t).getSelectedBikeStation)==null?void 0:F.availableRent)||0),1)]),zt,e("div",null,[Gt,e("span",jt,m(((D=i(t).getSelectedBikeStation)==null?void 0:D.availableReturn)||0),1)])])])):d("",!0)])}}});var Kt=tt(Yt,[["__scopeId","data-v-48ace480"]]);export{Kt as default};
