var fe=Object.defineProperty,me=Object.defineProperties;var pe=Object.getOwnPropertyDescriptors;var F=Object.getOwnPropertySymbols;var ye=Object.prototype.hasOwnProperty,be=Object.prototype.propertyIsEnumerable;var V=(e,t,o)=>t in e?fe(e,t,{enumerable:!0,configurable:!0,writable:!0,value:o}):e[t]=o,i=(e,t)=>{for(var o in t||(t={}))ye.call(t,o)&&V(e,o,t[o]);if(F)for(var o of F(t))be.call(t,o)&&V(e,o,t[o]);return e},f=(e,t)=>me(e,pe(t));import{l as g,A as h,B as C,C as _,D as Z,n as ve,E as S,G,m as q,w as J,H as K,r as R,o as W,b as Q,f as P,I as U,F as he,q as ge,J as Le,e as Se,t as Ae,s as Be,g as _e}from"./vendor.c9c0133b.js";import{u as je}from"./enum.7d5fc5f6.js";import{_ as Oe}from"./plugin-vue_export-helper.5a098b48.js";const X=(e,t)=>{let o;return function(...n){const s=this;o&&clearTimeout(o),o=setTimeout(()=>{e.apply(s,n),o=null},t)}},Ce=e=>!e||typeof e.charAt!="function"?e:e.charAt(0).toUpperCase()+e.slice(1),T=(e,t,o)=>{for(const n in o){const s="set"+Ce(n);e[s]?J(()=>o[n],(a,u)=>{e[s](a,u)}):t[s]&&J(()=>o[n],a=>{t[s](a)})}},k=e=>{const t={};for(const o in e)if(o.startsWith("on")&&!o.startsWith("onUpdate")&&o!=="onReady"){const n=o.slice(2).toLocaleLowerCase();t[n]=e[o]}return t},Te=async e=>{const t=await Promise.all([import("./marker-icon-2x.17982e67.js"),import("./marker-icon.c1a4cbf5.js"),import("./marker-shadow.91c47cf3.js")]);delete e.Default.prototype._getIconUrl,e.Default.mergeOptions({iconRetinaUrl:t[0].default,iconUrl:t[1].default,shadowUrl:t[2].default})},x=e=>{const t=g(()=>console.warn(`Method ${e} has been invoked without being replaced`)),o=(...n)=>t.value(...n);return o.wrapped=t,S(e,o),o},H=(e,t)=>e.wrapped.value=t,A=typeof self=="object"&&self.self===self&&self||typeof global=="object"&&global.global===global&&global||void 0,I="useGlobalLeaflet",D={options:{type:Object,default:()=>({})}},N=e=>({options:e.options,methods:{}}),Y=f(i({},D),{pane:{type:String,default:"overlayPane"},attribution:{type:String,default:null},name:{type:String,custom:!0,default:void 0},layerType:{type:String,custom:!0,default:void 0},visible:{type:Boolean,custom:!0,default:!0}}),ee=(e,t,o)=>{const n=h("addLayer"),s=h("removeLayer"),{options:a,methods:u}=N(e),r=f(i({},a),{attribution:e.attribution,pane:e.pane}),d=()=>n({leafletObject:t.value}),y=()=>s({leafletObject:t.value}),m=f(i({},u),{setAttribution(c,v){this.$parent.leafletObject.attributionControl.removeAttribution(v).addAttribution(c)},setName(){y(),e.visible&&d()},setLayerType(){y(),e.visible&&d()},setVisible(c){t.value&&(c?d():y())},bindPopup({leafletObject:c}){t.value.bindPopup(c)},bindTooltip({leafletObject:c}){t.value.bindTooltip(c)},unbindTooltip(){const c=t.value?t.value.getTooltip():null;c&&c.unbindTooltip()},unbindPopup(){const c=t.value?t.value.getPopup():null;c&&c.unbindPopup()},updateVisibleProp(c){o.emit("update:visible",c)}});return S("bindPopup",m.bindPopup),S("bindTooltip",m.bindTooltip),S("unbindTooltip",m.unbindTooltip),S("unbindPopup",m.unbindPopup),K(()=>{m.unbindPopup(),m.unbindTooltip(),y()}),{options:r,methods:m}},Ie=(e,t)=>{if(e&&t.default)return Z("div",{style:{display:"none"}},t.default())},Re=f(i({},D),{position:{type:String,default:"topright"}}),Pe=(e,t)=>{const{options:o,methods:n}=N(e),s=f(i({},o),{position:e.position}),a=f(i({},n),{setPosition(u){t.value&&t.value.setPosition(u)}});return K(()=>{t.value&&t.value.remove()}),{options:s,methods:a}},ke=f(i({},Re),{collapsed:{type:Boolean,default:!0},autoZIndex:{type:Boolean,default:!0},hideSingleBase:{type:Boolean,default:!1},sortLayers:{type:Boolean,default:!1},sortFunction:{type:Function,default:void 0}}),we=(e,t)=>{const{options:o}=Pe(e,t);return{options:f(i({},o),{collapsed:e.collapsed,autoZIndex:e.autoZIndex,hideSingleBase:e.hideSingleBase,sortLayers:e.sortLayers,sortFunction:e.sortFunction}),methods:{addLayer(a){a.layerType==="base"?t.value.addBaseLayer(a.leafletObject,a.name):a.layerType==="overlay"&&t.value.addOverlay(a.leafletObject,a.name)},removeLayer(a){t.value.removeLayer(a.leafletObject)}}}};var te={name:"LControlLayers",props:ke,setup(e,t){const o=g({}),n=h(I),s=h("registerLayerControl"),{options:a,methods:u}=we(e,o);return C(async()=>{const{control:r}=n?A.L:await import("./leaflet-src.esm.291dd8ba.js");o.value=r.layers(null,null,a),T(u,o.value,e),s(f(i(i({},e),u),{leafletObject:o.value})),_(()=>t.emit("ready",o.value))}),{leafletObject:o.value}},render(){return null}};te.__file="src/components/LControlLayers.vue";const Me=f(i({},Y),{pane:{type:String,default:"tilePane"},opacity:{type:Number,custom:!1,default:1},zIndex:{type:Number,default:1},tileSize:{type:Number,default:256},noWrap:{type:Boolean,default:!1},minZoom:{type:Number,default:0},maxZoom:{type:Number,default:void 0}}),ze=(e,t,o)=>{const{options:n,methods:s}=ee(e,t,o);return{options:f(i({},n),{pane:e.pane,opacity:e.opacity,zIndex:e.zIndex,tileSize:e.tileSize,noWrap:e.noWrap,minZoom:e.minZoom,maxZoom:e.maxZoom}),methods:i({},s)}},$e={iconUrl:{type:String,custom:!0,default:null},iconRetinaUrl:{type:String,custom:!0,default:null},iconSize:{type:[Object,Array],custom:!0,default:null},iconAnchor:{type:[Object,Array],custom:!0,default:null},popupAnchor:{type:[Object,Array],custom:!0,default:()=>[0,0]},tooltipAnchor:{type:[Object,Array],custom:!0,default:()=>[0,0]},shadowUrl:{type:String,custom:!0,default:null},shadowRetinaUrl:{type:String,custom:!0,default:null},shadowSize:{type:[Object,Array],custom:!0,default:null},shadowAnchor:{type:[Object,Array],custom:!0,default:null},bgPos:{type:[Object,Array],custom:!0,default:()=>[0,0]},className:{type:String,custom:!0,default:""},options:{type:Object,custom:!0,default:()=>({})}};var oe={name:"LIcon",props:i(i({},$e),D),setup(e,t){const o=g(null),n=h(I),s=h("canSetParentHtml"),a=h("setParentHtml"),u=h("setIcon");let r,d,y,m,c;const v=(O,w,M)=>{const z=O&&O.innerHTML;if(!w){M&&c&&s()&&a(z);return}const B=k(t.attrs);c&&d(c,B);const{options:E}=N(e),l=f(i({},E),{iconUrl:e.iconUrl,iconRetinaUrl:e.iconRetinaUrl,iconSize:e.iconSize,iconAnchor:e.iconAnchor,popupAnchor:e.popupAnchor,tooltipAnchor:e.tooltipAnchor,shadowUrl:e.shadowUrl,shadowRetinaUrl:e.shadowRetinaUrl,shadowSize:e.shadowSize,shadowAnchor:e.shadowAnchor,bgPos:e.bgPos,className:e.className,html:z||e.html});c=l.html?y(l):m(l),r(c,B),u(c)},p=()=>{_(()=>v(o.value,!0,!1))},L=()=>{_(()=>v(o.value,!1,!0))},j={setIconUrl:p,setIconRetinaUrl:p,setIconSize:p,setIconAnchor:p,setPopupAnchor:p,setTooltipAnchor:p,setShadowUrl:p,setShadowRetinaUrl:p,setShadowAnchor:p,setBgPos:p,setClassName:p,setHtml:p};return C(async()=>{const{DomEvent:O,divIcon:w,icon:M}=n?A.L:await import("./leaflet-src.esm.291dd8ba.js");r=O.on,d=O.off,y=w,m=M,T(j,{},e),new MutationObserver(L).observe(o.value,{attributes:!0,childList:!0,characterData:!0,subtree:!0}),p()}),{root:o}},render(){const e=this.$slots.default?this.$slots.default():void 0;return Z("div",{ref:"root"},e)}};oe.__file="src/components/LIcon.vue";var ne={emits:["ready","update:zoom","update:center","update:bounds"],props:f(i({},D),{center:{type:[Object,Array],default:()=>[0,0]},bounds:{type:[Array,Object],default:void 0},maxBounds:{type:[Array,Object],default:void 0},zoom:{type:Number,default:0},minZoom:{type:Number,default:void 0},maxZoom:{type:Number,default:void 0},paddingBottomRight:{type:Array,default:void 0},paddingTopLeft:{type:Array,default:void 0},padding:{type:Array,default:void 0},worldCopyJump:{type:Boolean,default:!1},crs:{type:[String,Object],default:"EPSG3857"},maxBoundsViscosity:{type:Number,default:void 0},inertia:{type:Boolean,default:void 0},inertiaDeceleration:{type:Number,default:void 0},inertiaMaxSpeed:{type:Number,default:void 0},easeLinearity:{type:Number,default:void 0},zoomAnimation:{type:Boolean,default:void 0},zoomAnimationThreshold:{type:Number,default:void 0},fadeAnimation:{type:Boolean,default:void 0},markerZoomAnimation:{type:Boolean,default:void 0},noBlockingAnimations:{type:Boolean,default:!1},useGlobalLeaflet:{type:Boolean,default:!1}}),setup(e,t){const o=g(null),n=ve({ready:!1,leafletRef:{},layersToAdd:[],layersInControl:[]}),{options:s}=N(e),a=f(i({},s),{minZoom:e.minZoom,maxZoom:e.maxZoom,maxBounds:e.maxBounds,maxBoundsViscosity:e.maxBoundsViscosity,worldCopyJump:e.worldCopyJump,crs:e.crs,center:e.center,zoom:e.zoom,inertia:e.inertia,inertiaDeceleration:e.inertiaDeceleration,inertiaMaxSpeed:e.inertiaMaxSpeed,easeLinearity:e.easeLinearity,zoomAnimation:e.zoomAnimation,zoomAnimationThreshold:e.zoomAnimationThreshold,fadeAnimation:e.fadeAnimation,markerZoomAnimation:e.markerZoomAnimation}),u=x("addLayer"),r=x("removeLayer"),d=x("registerControl"),y=x("registerLayerControl");S(I,e.useGlobalLeaflet);const m={moveEndHandler(){t.emit("update:zoom",n.leafletRef.getZoom()),t.emit("update:center",n.leafletRef.getCenter()),t.emit("update:bounds",n.leafletRef.getBounds())},overlayAddHandler(p){const L=n.layersInControl.find(j=>j.name===p.name);L&&L.updateVisibleProp(!0)},overlayRemoveHandler(p){const L=n.layersInControl.find(j=>j.name===p.name);L&&L.updateVisibleProp(!1)}};C(async()=>{e.useGlobalLeaflet&&(A.L=A.L||await import("./leaflet-src.34984b23.js").then(function(l){return l.l}));const{map:p,CRS:L,Icon:j,latLngBounds:O,latLng:w,DomEvent:M}=e.useGlobalLeaflet?A.L:await import("./leaflet-src.esm.291dd8ba.js");try{a.beforeMapMount&&await a.beforeMapMount()}catch(l){console.error(`The following error occurred running the provided beforeMapMount hook ${l.message}`)}await Te(j);const z=typeof a.crs=="string"?L[a.crs]:a.crs;a.crs=z||L.EPSG3857;const B={addLayer(l){l.layerType!==void 0&&(n.layerControl===void 0?n.layersToAdd.push(l):n.layersInControl.find($=>$.leafletObject._leaflet_id===l.leafletObject._leaflet_id)||(n.layerControl.addLayer(l),n.layersInControl.push(l))),l.visible!==!1&&n.leafletRef.addLayer(l.leafletObject)},removeLayer(l){l.layerType!==void 0&&(n.layerControl===void 0?n.layersToAdd=n.layersToAdd.filter(b=>b.name!==l.name):(n.layerControl.removeLayer(l.leafletObject),n.layersInControl=n.layersInControl.filter(b=>b.leafletObject._leaflet_id!==l.leafletObject._leaflet_id))),n.leafletRef.removeLayer(l.leafletObject)},registerLayerControl(l){n.layerControl=l,n.layersToAdd.forEach(b=>{n.layerControl.addLayer(b)}),n.layersToAdd=[],d(l)},registerControl(l){n.leafletRef.addControl(l.leafletObject)},setZoom(l){const b=n.leafletRef.getZoom();l!==b&&n.leafletRef.setZoom(l,{animate:e.noBlockingAnimations?!1:null})},setPaddingBottomRight(l){n.paddingBottomRight=l},setPaddingTopLeft(l){n.paddingTopLeft=l},setPadding(l){n.padding=l},setCrs(l){const b=n.leafletRef.getBounds();n.leafletRef.options.crs=l,n.leafletRef.fitBounds(b,{animate:!1,padding:[0,0]})},fitBounds(l){n.leafletRef.fitBounds(l,{animate:this.noBlockingAnimations?!1:null})},setBounds(l){if(!l)return;const b=O(l);if(!b.isValid())return;!(n.lastSetBounds||n.leafletRef.getBounds()).equals(b,0)&&(n.lastSetBounds=b,n.leafletRef.fitBounds(b,this.fitBoundsOptions))},setCenter(l){if(l==null)return;const b=w(l),$=n.lastSetCenter||n.leafletRef.getCenter();($.lat!==b.lat||$.lng!==b.lng)&&(n.lastSetCenter=b,n.leafletRef.panTo(b,{animate:this.noBlockingAnimations?!1:null}))}};H(u,B.addLayer),H(r,B.removeLayer),H(d,B.registerControl),H(y,B.registerLayerControl),n.leafletRef=p(o.value,a),T(B,n.leafletRef,e);const E=k(t.attrs);n.leafletRef.on("moveend",X(m.moveEndHandler,100)),n.leafletRef.on("overlayadd",m.overlayAddHandler),n.leafletRef.on("overlayremove",m.overlayRemoveHandler),M.on(n.leafletRef,E),n.ready=!0,_(()=>t.emit("ready",n.leafletRef))}),G(()=>{n.leafletRef&&n.leafletRef.remove()});const c=q(()=>n.leafletRef),v=q(()=>n.ready);return{root:o,ready:v,leafletObject:c}},render(){return Z("div",{style:{width:"100%",height:"100%"},ref:"root"},this.ready?this.$slots.default():{})}};ne.__file="src/components/LMap.vue";const Ue=f(i({},Y),{pane:{type:String,default:"markerPane"},draggable:{type:Boolean,custom:!0,default:!1},latLng:{type:[Object,Array],custom:!0,default:null},icon:{type:[Object],default:()=>{},custom:!1},zIndexOffset:{type:Number,custom:!1,default:null}}),De=(e,t,o)=>{const{options:n,methods:s}=ee(e,t,o),a=i(i({},n),e),u=f(i({},s),{setDraggable(r){t.value.dragging&&(r?t.value.dragging.enable():t.value.dragging.disable())},latLngSync(r){o.emit("update:latLng",r.latlng),o.emit("update:lat-lng",r.latlng)},setLatLng(r){if(r!=null&&t.value){const d=t.value.getLatLng();(!d||!d.equals(r))&&t.value.setLatLng(r)}}});return{options:a,methods:u}};var ae={name:"LMarker",props:Ue,setup(e,t){const o=g({}),n=g(!1),s=h(I),a=h("addLayer");S("canSetParentHtml",()=>!!o.value.getElement()),S("setParentHtml",d=>o.value.getElement().innerHTML=d),S("setIcon",d=>o.value.setIcon&&o.value.setIcon(d));const{options:u,methods:r}=De(e,o,t);return u.icon===void 0&&delete u.icon,C(async()=>{const{marker:d,DomEvent:y}=s?A.L:await import("./leaflet-src.esm.291dd8ba.js");o.value=d(e.latLng,u);const m=k(t.attrs);y.on(o.value,m),o.value.on("move",X(r.latLngSync,100)),T(r,o.value,e),a(f(i(i({},e),r),{leafletObject:o.value})),n.value=!0,_(()=>t.emit("ready",o.value))}),{ready:n,leafletObject:o}},render(){return Ie(this.ready,this.$slots)}};ae.__file="src/components/LMarker.vue";const le=f(i({},D),{content:{type:String,default:null}}),se=(e,t)=>{const{options:o,methods:n}=N(e),s=f(i({},n),{setContent(a){t.value&&a!==null&&a!==void 0&&t.value.setContent(a)}});return{options:o,methods:s}},ie=e=>e.default?Z("div",{ref:"root"},e.default()):null,Ne=f(i({},le),{latLng:{type:[Object,Array],default:()=>[]}}),Ze=(e,t)=>{const{options:o,methods:n}=se(e,t),s=h("unbindPopup");return G(()=>{s()}),{options:o,methods:n}};var re={name:"LPopup",props:Ne,setup(e,t){const o=g({}),n=g(null),s=h(I),a=h("bindPopup"),{options:u,methods:r}=Ze(e,o);return C(async()=>{const{popup:d,DomEvent:y}=s?A.L:await import("./leaflet-src.esm.291dd8ba.js");o.value=d(u),e.latLng!==void 0&&o.value.setLatLng(e.latLng),T(r,o.value,e);const m=k(t.attrs);y.on(o.value,m),o.value.setContent(e.content||n.value),a({leafletObject:o.value}),_(()=>t.emit("ready",o.value))}),{root:n,leafletObject:o}},render(){return ie(this.$slots)}};re.__file="src/components/LPopup.vue";const ue=f(i({},Me),{tms:{type:Boolean,default:!1},subdomains:{type:String,default:"abc"},detectRetina:{type:Boolean,default:!1},url:{type:String,default:null}}),xe=(e,t)=>{const{options:o,methods:n}=ze(e,t);return{options:f(i({},o),{tms:e.tms,subdomains:e.subdomains,detectRetina:e.detectRetina}),methods:i({},n)}};var de={props:ue,setup(e,t){const o=g({}),n=h(I),s=h("addLayer"),{options:a,methods:u}=xe(e,o);return C(async()=>{const{tileLayer:r,DomEvent:d}=n?A.L:await import("./leaflet-src.esm.291dd8ba.js");o.value=r(e.url,a);const y=k(t.attrs);d.on(o.value,y),T(u,o.value,e),s(f(i(i({},e),u),{leafletObject:o.value})),_(()=>t.emit("ready",o.value))}),{leafletObject:o}},render(){return null}};de.__file="src/components/LTileLayer.vue";const He=i({},le),Ee=(e,t)=>{const{options:o,methods:n}=se(e,t),s=h("unbindTooltip");return G(()=>{s()}),{options:o,methods:n}};var ce={name:"LTooltip",props:He,setup(e,t){const o=g({}),n=g(null),s=h(I),a=h("bindTooltip"),{options:u,methods:r}=Ee(e,o);return C(async()=>{const{tooltip:d,DomEvent:y}=s?A.L:await import("./leaflet-src.esm.291dd8ba.js");o.value=d(u),T(r,o.value,e);const m=k(t.attrs);y.on(o.value,m),o.value.setContent(e.content||n.value),a({leafletObject:o.value}),_(()=>t.emit("ready",o.value))}),{root:n,leafletObject:o}},render(){return ie(this.$slots)}};ce.__file="src/components/LTooltip.vue";f(i({},ue),{baseUrl:{type:String,default:null,required:!0},layers:{type:String,default:""},styles:{type:String,default:""},format:{type:String,default:"image/jpeg"},transparent:{type:Boolean,custom:!1},version:{type:String,default:"1.1.1"},crs:{default:null},upperCase:{type:Boolean,default:!1}});const Ge={components:{LMap:ne,LIcon:oe,LTileLayer:de,LMarker:ae,LControlLayers:te,LTooltip:ce,LPopup:re},props:["location","stations","availability","isRent"],data(){return{zoom:16,iconWidth:25,iconHeight:40}},computed:{iconUrl(){return`https://placekitten.com/${this.iconWidth}/${this.iconHeight}`},iconSize(){return[this.iconWidth,this.iconHeight]},availabilityMap(){let e={};for(let t in this.availability)e[this.availability[t].StationUID]=this.availability[t];return e},stationMap(){let e={};for(let t in this.stations)e[this.stations[t].StationUID]=this.stations[t];return e}},methods:{log(e){console.log(e)},selectMarker(e){console.log("set bike station:",e);let t={};t.name=this.stationMap[e].StationName.Zh_tw,t.address=this.stationMap[e].StationAddress.Zh_tw,t.availableRent=this.availabilityMap[e].AvailableRentBikes,t.availableReturn=this.availabilityMap[e].AvailableReturnBikes,je().setSelectedBikeStation(t)},getRentReturnInfo(e){return this.availabilityMap[e]?this.isRent?this.availabilityMap[e].AvailableRentBikes:this.availabilityMap[e].AvailableReturnBikes:-1}}},We={style:{height:"100%",width:"100%"}},Fe=_e(" \u4F60\u5728\u9019\u88E1 ");function Ve(e,t,o,n,s,a){const u=R("l-tile-layer"),r=R("l-control-layers"),d=R("l-icon"),y=R("l-marker"),m=R("l-popup"),c=R("l-map");return W(),Q("div",We,[P(c,{modelValue:s.zoom,"onUpdate:modelValue":t[0]||(t[0]=v=>s.zoom=v),zoom:s.zoom,"onUpdate:zoom":t[1]||(t[1]=v=>s.zoom=v),center:o.location},{default:U(()=>[P(u,{url:"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png"}),P(r),(W(!0),Q(he,null,ge(o.stations,v=>(W(),Le(y,{key:v,"lat-lng":[v.StationPosition.PositionLat,v.StationPosition.PositionLon],onClick:p=>a.selectMarker(v.StationUID)},{default:U(()=>[P(d,null,{default:U(()=>[Se("div",{class:Be({dialogBox:!0,empty:this.getRentReturnInfo(v.StationUID)==0,rare:this.getRentReturnInfo(v.StationUID)>=1,enough:this.getRentReturnInfo(v.StationUID)>5})},Ae(this.getRentReturnInfo(v.StationUID)),3)]),_:2},1024)]),_:2},1032,["lat-lng","onClick"]))),128)),P(y,{"lat-lng":o.location},{default:U(()=>[P(m,null,{default:U(()=>[Fe]),_:1})]),_:1},8,["lat-lng"])]),_:1},8,["modelValue","zoom","center"])])}var Ye=Oe(Ge,[["render",Ve]]);export{Ye as M};
